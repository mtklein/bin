#!/usr/bin/env python

import sys

a = {}
b = {}

for (path, d) in [(sys.argv[1], a), (sys.argv[2], b)]:
  for line in open(path):
    try:
      time, label = line.split()
      d[label] = float(time)
    except:
      pass

common = set(a.keys()).intersection(b.keys())

def safe_divide(x, y):
  if y == 0:
    if x == 0:
      return 1
    return float('inf')
  return x/y

total_b, total_a = 0, 0
ratio_products = 1.0
maximum = 0
for label in common:
  total_b += b[label]
  total_a += a[label]
  ratio = safe_divide(b[label], a[label])
  maximum = max(ratio, maximum)
  if ratio != float('inf'):
      ratio_products *= ratio
  print '%.2g %s %g %g' % (ratio, label, a[label], b[label])

mean = safe_divide(total_b, total_a)
geomean = ratio_products ** (1.0 / len(common))
print '999 geomean  %.2g' % mean
print '999 arithmean %.2g' % geomean
print '999 maximum %.2g' % maximum
